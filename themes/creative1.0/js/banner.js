var __bind = function (e, t) { return function () { return e.apply(t, arguments) } }; !function (e) { return this.FilmRoll = function () { function n(n) { this.options = null != n ? n : {}, this.rotateRight = __bind(this.rotateRight, this), this.rotateLeft = __bind(this.rotateLeft, this), this.resize = __bind(this.resize, this), this.moveRight = __bind(this.moveRight, this), this.moveLeft = __bind(this.moveLeft, this), this.configureWidths = __bind(this.configureWidths, this), this.configureSwipe = __bind(this.configureSwipe, this), this.configureScroll = __bind(this.configureScroll, this), this.configureLoad = __bind(this.configureLoad, this), this.configureHover = __bind(this.configureHover, this), this.clearScroll = __bind(this.clearScroll, this), this.options.container && (this.div = e(this.options.container), this.div.length && this.configure()) } return n.prototype.configure = function () { var r, s = this; return this.children = this.div.children(), this.children.wrapAll('<div class="film_roll_wrapper"></div>'), this.children.wrapAll('<div class="film_roll_shuttle"></div>'), this.wrapper = this.div.find(".film_roll_wrapper"), this.shuttle = this.div.find(".film_roll_shuttle"), this.rotation = [], this.shuttle.width(this.options.shuttle_width ? parseInt(this.options.shuttle_width, 10) : 1e4), this.options.start_height && this.wrapper.height(parseInt(this.options.start_height, 10)), this.options.vertical_center && this.shuttle.addClass("vertical_center"), this.options.no_css === !0 || document.film_roll_styles_added || (e("<style type='text/css'></style>").appendTo("head"), document.film_roll_styles_added = !0), this.options.pager !== !1 && (this.pager = e('<div class="film_roll_pager">'), this.div.append(this.pager), this.children.each(function (n, r) { var i; return i = e("<a href='#' data-id='" + r.id + "'><span>" + (n + 1) + "</span></a>"), s.pager.append(i), i.click(function () { return s.index = n, s.moveToIndex(s.index, "best", !0), !1 }) })), this.pager_links = this.div.find(".film_roll_pager a"), "scroll" === this.options.hover ? (this.options.scroll = !1, this.hover_in = function () { return clearTimeout(s.hover_timer), s.hover_timer = setTimeout(function () { return s.moveLeft(), s.configureScroll() }, 300) }, this.hover_out = this.clearScroll) : this.options.hover !== !1 && (this.hover_in = function () { return clearTimeout(s.hover_timer), s.hover_timer = setTimeout(function () { return s.clearScroll() }, 300) }, this.hover_out = this.configureScroll), this.options.hover !== !1 && (this.mouse_catcher = e('<div style="position:absolute; top:0; left: 0; height: 100%; width: 100%;" class="film_roll_mouse_catcher"></div>'), this.mouse_catcher.appendTo(this.wrapper).mousemove(function () { return s.hover_in(), s.mouse_catcher.remove() })), r = null, this.children.each(function (n, r) { var i; return i = e(r), i.attr("data-film-roll-child-id", n), i.addClass("film_roll_child"), s.rotation.push(r) }), this.options.prev && this.options.next ? (this.prev = e(this.options.prev), this.next = e(this.options.next)) : (this.wrapper.append('<div class="film_roll_btn_div"><div class="film_roll_prev" href="#"></div><div class="film_roll_next" href="#"></div></div>'), this.prev = this.div.find(".film_roll_prev"), this.next = this.div.find(".film_roll_next")), this.prev.click(function () { return s.moveRight() }), this.next.click(function () { return s.moveLeft() }), this.index = this.options.start_index || 0, this.interval = this.options.interval || 4e3, this.animation = this.options.animation || this.interval / 4, this.easing = this.options.easing || n.default_easing, this.options.resize !== !1 && e(window).resize(function () { return s.resize() }), this.options.configure_load ? "function" == typeof this.options.configure_load ? this.options.configure_load.apply(this, arguments) : this.configureLoad() : e(window).load(this.configureLoad), this.options.swipe !== !1 && this.configureSwipe(), this.div.trigger(e.Event("film_roll:dom_ready")), this }, n.prototype.bestDirection = function (n, r) { return r || (r = e.inArray(n, this.rotation)), r < this.children.length / 2 ? "right" : "left" }, n.prototype.childIndex = function (n) { return e.inArray(n, this.children) }, n.prototype.childWidth = function (n) { var r; return r = this.childIndex(n), this.child_widths[r] || e(n).outerWidth(!0) }, n.prototype.clearScroll = function () { return this.scrolled !== !1 && (clearInterval(this.timer), this.scrolled = !1), this }, n.prototype.configureHover = function () { return this.div.hover(this.hover_in, this.hover_out), this.options.prev && this.options.next ? (this.prev.hover(this.hover_in, this.hover_out), this.next.hover(this.hover_in, this.hover_out)) : void 0 }, n.prototype.configureLoad = function () { return this.configureWidths(), this.moveToIndex(this.index, "right", !0), "scroll" === this.options.hover ? (this.options.scroll = !1, this.configureHover()) : this.options.scroll !== !1 && (this.configureScroll(), this.options.hover !== !1) ? this.configureHover() : void 0 }, n.prototype.configureScroll = function () { var e = this; return this.scrolled !== !0 && (this.timer = setInterval(function () { return e.moveLeft() }, this.interval), this.scrolled = !0), this }, n.prototype.configureSwipe = function () { var n = this; return "undefined" != typeof e.fn.swipe ? (this.div.swipe({ swipeStatus: function (r, s, o, u) { var a, f; if ("up" === o || "down" === o) return !1; if ("start" === s) { if (f = n.wrapper.width(), f >= n.real_width || 1 === n.children.length) return !1; n.was_scrolled = n.scrolled, n.scrolled && n.clearScroll(), n.active_half = n.child_widths[n.index] / 2, a = e.inArray(n.children[n.index], n.rotation), n.offscreen_left = parseInt(n.shuttle.css("left"), 10), n.offscreen_right = n.marginRight(a) - (f - n.child_widths[n.index]) / 2 } else "move" === s ? "left" === o ? (u > n.active_half && (e(n.children[n.index]).removeClass("active"), n.index = (n.index + 1) % n.children.length, e(n.children[n.index]).addClass("active"), n.active_half += n.child_widths[n.index]), u > n.offscreen_right && (n.offscreen_left = n.rotateLeft() + u, n.offscreen_right += n.childWidth(n.rotation[n.rotation.length - 1])), n.shuttle.css("left", n.offscreen_left - u)) : (u > n.active_half && (e(n.children[n.index]).removeClass("active"), n.index -= 1, n.index < 0 && (n.index = n.children.length - 1), e(n.children[n.index]).addClass("active"), n.active_half += n.child_widths[n.index]), u + n.offscreen_left > 0 && (n.offscreen_left = n.rotateRight() - u), n.shuttle.css("left", n.offscreen_left + u)) : ("end" === s ? n.moveToIndex(n.index, o) : "cancel" === s && n.moveToIndex(n.index, "right" === o ? "left" : "right"), n.was_scrolled && n.configureScroll()); return !0 }, excludedElements: "label, button, input, select, textarea, .noSwipe", allowPageScroll: "vertical" }), this.div.find("a").on("click", this.cancelClick)) : void 0 }, n.prototype.configureWidths = function () { var n, r = this; return this.width = n = 0, this.wrapper.css({ height: "", "min-height": 0 }), this.shuttle.width("").removeClass("film_roll_shuttle").addClass("film_roll_resizing"), this.children.width(""), this.div.trigger(e.Event("film_roll:resizing")), this.child_widths = [], this.options.height && this.options.height.toString().match(/^\+/) ? (this.options.height_padding = parseInt(this.options.height, 10), this.options.height = null) : this.options.height_padding = 0, this.children.each(function (s, o) { var u, a, f; return u = e(o), u.width(u.outerWidth(!0)), f = u.outerWidth(!0), r.child_widths.push(f), r.width += f, r.options.height || (a = u.outerHeight(!0), a > n && (n = a)), o }), this.options.height ? this.wrapper.height(this.options.height) : (this.wrapper.height(""), this.wrapper.css("min-height", n + this.options.height_padding)), this.real_width = this.width, this.shuttle.width(2 * this.real_width).removeClass("film_roll_resizing").addClass("film_roll_shuttle"), this }, n.prototype.rotationIndex = function (n) { return e.inArray(n, this.rotation) }, n.prototype.marginLeft = function (e) { var t, n, r, i, s, o; for (r = 0, o = this.rotation, n = i = 0, s = o.length; s > i; n = ++i) t = o[n], e > n && n >= 0 && (r += this.childWidth(t)); return r }, n.prototype.marginRight = function (e) { var t, n, r, i, s, o, u; for (i = this.rotation.length - 1, r = 0, u = this.rotation, n = s = 0, o = u.length; o > s; n = ++s) t = u[n], n > e && i >= n && (r += this.childWidth(t)); return r }, n.prototype.moveLeft = function () { return this.index = (this.index + 1) % this.children.length, this.moveToIndex(this.index, "left", !0), !1 }, n.prototype.moveRight = function () { return this.index -= 1, this.index < 0 && (this.index = this.children.length - 1), this.moveToIndex(this.index, "right", !0), !1 }, n.prototype.moveToChild = function (n) { var r; return r = this.childIndex(e(n)[0]), r > -1 ? this.moveToIndex(r) : void 0 }, n.prototype.moveToIndex = function (n, r, i) { var s, o, u, a, f, l, c, h = this; if (null == i && (i = !0), this.index = n, f = this.scrolled, this.clearScroll(), s = this.children[n], a = e.inArray(s, this.rotation), r && "best" !== r || (r = this.bestDirection(s, a)), this.children.removeClass("active"), e(s).addClass("active").trigger(e.Event("film_roll:activate")), this.pager_links.removeClass("active"), e(this.pager_links[n]).addClass("active"), c = this.wrapper.width(), c < this.real_width && this.children.length > 1) { if (l = (c - this.child_widths[n]) / 2, "right" === r) for (; 0 === a || this.marginLeft(a) < l;) this.rotateRight(), a = e.inArray(s, this.rotation); else for (; a === this.children.length - 1 || this.marginRight(a) < l;) this.rotateLeft(), a = e.inArray(s, this.rotation); u = -1 * (this.marginLeft(a) - l), i ? (o = "moving_" + r, this.shuttle.addClass(o), this.div.trigger(e.Event("film_roll:moving")), this.shuttle.stop().animate({ left: u }, this.animation, this.easing, function () { return h.shuttle.removeClass(o), h.div.trigger(e.Event("film_roll:moved")) })) : (this.shuttle.css("left", u), this.div.trigger(e.Event("film_roll:moved"))) } else this.shuttle.css("left", (c - this.width) / 2); return f && this.configureScroll(), this }, n.prototype.resize = function () { var n = this; return clearTimeout(this.resize_timer), this.resize_timer = setTimeout(function () { var r; return r = n.scrolled, n.clearScroll(), r && n.configureScroll(), n.configureWidths(), n.moveToIndex(n.index, "best"), n.div.trigger(e.Event("film_roll:resized")) }, 200), this }, n.prototype.rotateLeft = function () { var e, t, n, r; return e = this.shuttle.css("left"), r = e ? parseInt(e, 10) : 0, t = this.rotation.shift(), n = r + this.childWidth(t), this.rotation.push(t), this.shuttle.css("left", n), this.shuttle.append(this.shuttle.children().first().detach()), n }, n.prototype.rotateRight = function () { var e, t, n, r; return e = this.shuttle.css("left"), r = e ? parseInt(e, 10) : 0, t = this.rotation.pop(), n = r - this.childWidth(t), this.rotation.unshift(t), this.shuttle.css("left", n), this.shuttle.prepend(this.shuttle.children().last().detach()), n }, n }(), this.FilmRoll.default_easing = "swing" }(jQuery)