var friendsInviter = function () { function e(e, t, i) { var n = 0; "number" == typeof window.innerWidth ? n = window.innerWidth : document.documentElement && document.documentElement.clientWidth ? n = document.documentElement.clientWidth : document.body && document.body.clientWidth && (n = document.body.clientWidth); var l = 0; "number" == typeof window.innerHeight ? l = window.innerHeight : document.documentElement && document.documentElement.clientHeight ? l = document.documentElement.clientHeight : document.body && document.body.clientHeight && (l = document.body.clientHeight); var c = 800; try { c = void 0 != document.height ? document.height : document.body.offsetHeight } catch (o) { } var s = e, r = n / 2, a = s / 2, d = r - a, p = t, v = l / 2, u = p / 2, h = v - u; "popup" == i && null != document.getElementById("popupFIcontainer") && (document.getElementById("popupFIcontainer").style.left = d + "px", document.getElementById("popupFIcontainer").style.top = h + "px", document.getElementById("overlay").style.height = c + "px") } var t = {}, i = {}, n = [], l = "", c = !1, o = function () { }, s = { twitter: { name: "twitter", type: "oAuth", icon: "twitter_logo.png" }, linkedin: { name: "linkedin", type: "oAuth", icon: "linkedin_logo.png" }, skyrock: { name: "skyrock", type: "oAuth", icon: "skyrock_logo.png" }, sonico: { name: "sonico", type: "oAuth", icon: "sonico_logo.png" } }, r = function (e, t) { for (var i = e.length, n = "", l = 0; i > l; l++) { var c = ""; c += '<li data="' + e[l].id + '" ' + (e[l].selected ? 'class="tpl-contacts-li-select"' : "") + ">", c += '<div class="tpl-contacts-holder fl" title="' + e[l].name + '">', c += '<div class="fl tpl-left"><img src="' + e[l].img + '" /></div>', c += '<div class="fl tpl-right">', c += '<div class="tpl-right-inner">' + e[l].name + "</div>", c += "</div></div></li>", "selected" == t && e[l].selected ? (n += c, u(e[l], e[l].selected)) : "all" == t && (n += c, u(e[l], e[l].selected)) } 0 == i ? $(".inviter-tpl .tpl-contacts").addClass("all" == t ? "tpl-noresultsfound" : "tpl-nofriendsselected") : $(".inviter-tpl .tpl-contacts").removeClass("tpl-noresultsfound").removeClass("tpl-nofriendsselected"), $(".inviter-tpl .tpl-contacts-list").html(n), $(".inviter-tpl .tpl-contacts-li-select").length > 0 && $(".inviter-tpl .tpl-contacts-li-select").append('<div class="tpl-contacts-li-select-iconholder posrel"><div class="tpl-contacts-li-select-icon posabs"></div></div>'), $(".inviter-tpl .selected-contacts").html("selected (0)"), a(e), g(), $("body,html").animate({ scrollTop: 570 }, 800) }, a = function (e) { for (var t = e.length, i = [], n = {}, l = 0; t > l; l++) { var c = e[l].name; if (-1 != c.indexOf(" ")) for (var o = c.split(" "), s = o.length, r = 0; s > r; r++) n[o[r]] = o[r]; else n[c] = c } for (var a in n) n.hasOwnProperty(a) && i.push(n[a]); $(".inviter-tpl .searchTxt").autocomplete({ source: function (e, t) { var n = $.ui.autocomplete.filter(i, e.term); t(n.slice(0, 8)) }, select: function (e, t) { O(t.item.value) } }) }, d = function (e) { for (var t = e.length, i = 0; t > i; i++) u(e[i], e[i].selected) }, p = function (e) { var t; if (!e) var e = window.event; return e.keyCode ? t = e.keyCode : e.which && (t = e.which), 13 == t ? (friendsInviter.showsearch($(".inviter-tpl .searchTxt").val()), !1) : void 0 }, v = function () { var e = '<div class="tpl-service-list posrel"><div class="posabs service-list"><ul>'; for (var t in s) s.hasOwnProperty(t) && (e += '<li class="fl" service="' + t + '"><img src="images/' + s[t].icon + '" /></li>'); e += "</ul></div></div>"; var i = '<div class="fl tpl-header-wrapper marTop5">'; i += '<div class="fl marTop4 fl tpl-header-icon"><div class="fl service-holder"><div class="fl"><img class="img" src="images/facebook_logo.png" /></div><div class="service-icon fr"></div></div></div>' + e, i += '<div class="fr marRight10 selected-contacts tpl-default">Selected</div>', i += '<div class="fr marRight10 all-contacts tpl-default">All</div>', i += '<div class="fr marRight10 clear-contacts tpl-default">Clear</div>', i += '<div class="fr marRight10 tpl-default">', i += '<input type="text" id="txtsearch" onkeydown="javascript:return friendsInviter.listener(event)" onclick="friendsInviter.showAll();" autocomplete="off" class="ac_input searchTxt textclass">', i += "</div>", i += '<div class="fr marRight10 tpl-default">Search </div>', i += "</div>"; var n = '<div class="tpl-contacts-wrapper"><ul class="tpl-contacts-list"></ul></div>'; $(".inviter-tpl .tpl-header").html(i), $(".inviter-tpl .tpl-contacts").html(n), $(".inviter-tpl .tpl-footer").after('<div class="tpl-ad fl fullWid"><div class="fr powered"><span>Powered by </span><span><a href="http://stescodes.com/invitefriends.aspx" target="_blank">StesCodes.com</a></span></div></div>') }, u = function (e, i) { void 0 == t[e.id] && (t[e.id] = {}, t[e.id].selected = i, t[e.id].id = e.id, t[e.id].img = e.imageurl, t[e.id].name = e.name) }, h = function (e) { var i = e.attr("data"); t[i] = {}, t[i].selected = !0, t[i].id = i, t[i].img = e.find("img").attr("src"), t[i].name = e.find(".tpl-contacts-holder").attr("title"), $(".inviter-tpl .selected-contacts").html("selected (" + (f() + 1) + ")") }, m = function (e) { var i = e.attr("data"); t[i].selected = !1, $(".inviter-tpl .selected-contacts").html("selected (" + (f() - 1) + ")") }, f = function () { var e = $(".inviter-tpl .selected-contacts").html(); return parseInt(e.substring(e.indexOf("(") + 1, e.indexOf(")"))) }, g = function () { $(".inviter-tpl .tpl-contacts-holder").unbind("click mouseover mouseout"), $(".inviter-tpl .tpl-contacts-holder").bind({ mouseover: function () { $(this).closest("li").addClass("tpl-contacts-li-hover") }, mouseout: function () { $(this).closest("li").removeClass("tpl-contacts-li-hover") }, click: function () { var e = $(this).closest("li"); e.hasClass("tpl-contacts-li-select") ? (friendsInviter.deSelect(e), e.removeClass("tpl-contacts-li-select").removeClass("tpl-contacts-li-hover").find(".tpl-contacts-li-select-iconholder").remove()) : "facebook" == l ? ($(".tpl-contacts-li-select").closest("li").each(function () { var e = $(this); friendsInviter.deSelect(e), e.removeClass("tpl-contacts-li-select").removeClass("tpl-contacts-li-hover").find(".tpl-contacts-li-select-iconholder").remove() }), friendsInviter.select(e), e.addClass("tpl-contacts-li-select"), e.append('<div class="tpl-contacts-li-select-iconholder posrel"><div class="tpl-contacts-li-select-icon posabs"></div></div>')) : (friendsInviter.select(e), e.addClass("tpl-contacts-li-select"), e.append('<div class="tpl-contacts-li-select-iconholder posrel"><div class="tpl-contacts-li-select-icon posabs"></div></div>')) } }), $(".inviter-tpl .selected-contacts").unbind("click"), $(".inviter-tpl .selected-contacts").click(function () { friendsInviter.showSelected() }), $(".inviter-tpl .all-contacts").unbind("click"), $(".inviter-tpl .all-contacts").click(function () { friendsInviter.showAll() }), $(".inviter-tpl .clear-contacts").unbind("click"), $(".inviter-tpl .clear-contacts").click(function () { friendsInviter.clearSelection() }), $(".inviter-tpl .sendBtn").unbind("click"), $(".inviter-tpl .sendBtn").click(function () { $(".inviter-tpl .ui-send-loading").show(); for (var e = [], t = friendsInviter.getSelected(), i = t.length, n = 0; i > n; n++) e.push(t[n].id); e = e.join(","), o(e, l) }) }, y = function () { }, w = function (e) { $(".inviter-tpl .ui-send-loading").hide(), "" == e.error ? (y(C(), l), k(), alert(e.status)) : alert(e.error) }, b = function () { return l }, I = function () { return t }, k = function () { for (var e in t) t.hasOwnProperty(e) && (t[e].selected = !1); $(".inviter-tpl .tpl-contacts-li-select-iconholder").remove(), $(".inviter-tpl .tpl-contacts-li-select").each(function () { $(this).removeClass("tpl-contacts-li-select") }), $(".inviter-tpl .selected-contacts").html("selected (0)") }, x = function () { var e = [], i = 0; for (var n in t) t.hasOwnProperty(n) && (t[n].selected && i++, e.push({ name: t[n].name, id: t[n].id, img: t[n].img, selected: t[n].selected ? !0 : !1 })); r(e, "all"), $(".inviter-tpl .selected-contacts").html("selected (" + i + ")") }, C = function () { var e = []; for (var i in t) t.hasOwnProperty(i) && t[i].selected && e.push({ name: t[i].name, id: t[i].id, img: t[i].img, selected: t[i].selected ? !0 : !1 }); return e }, F = function () { var e = []; n = []; for (var l in t) if (t.hasOwnProperty(l)) if (e.push({ name: t[l].name, id: t[l].id, img: t[l].img, selected: t[l].selected ? !0 : !1 }), -1 != $.trim(t[l].name).indexOf(" ")) for (var c = t[l].name.split(" "), o = c.length, s = 0; o > s; s++) void 0 == i[c[s]] && (i[c[s]] = c[s]); else void 0 == i[t[l].name] && (i[t[l].name] = t[l].name); for (var l in i) i.hasOwnProperty(l) && i[l] && n.push(i[l]); return e }, S = function () { var e = []; for (var i in t) t.hasOwnProperty(i) && t[i].selected && e.push({ name: t[i].name, id: t[i].id, img: t[i].img, selected: t[i].selected ? !0 : !1 }); r(e, "selected"), $(".inviter-tpl .selected-contacts").html("selected (" + e.length + ")") }, O = function (e) { e = e.replace("</strong>", ""), e = e.replace("<strong>", ""); var i = [], n = 0; for (var l in t) t.hasOwnProperty(l) && (-1 != t[l].name.toLowerCase().indexOf(e.toLowerCase()) && i.push({ name: t[l].name, id: t[l].id, img: t[l].img, selected: t[l].selected ? !0 : !1 }), t[l].selected && n++); r(i, "all"), $(".inviter-tpl .selected-contacts").html("selected (" + n + ")") }, _ = function (e, i) { return 1 == c && friendsInviter.overlay("visible", "popup"), $("#popupFIcontainer").show(), l = e, "facebook" == e ? ($(".inviter-tpl .tpl-loading").html("Facebook service is not available in trial version."), $(".inviter-tpl").show(), $(".inviter-tpl .tpl-loading").css("background-image", "none"), alert("Facebook service is not availe in trial version."), !1) : ($(".inviter-tpl .tpl-loading").css("background-image", "url(./images/sload.gif)"), $(".inviter-tpl .tpl-loading").html("Please authorize your account..."), $(".inviter-tpl").show(), $(".inviter-tpl .tpl-loading").show(), $(".inviter-tpl .tpl-default").hide(), t = {}, $(".inviter-tpl .tpl-header-icon img").attr("src", "images/" + e + "_logo.png"), void window.open("oauth.aspx?currpage=" + e + "&signature=" + i, "mywindow", "location=1,status=1,scrollbars=1,width=700,height=400")) }, T = function () { $(".inviter-tpl .tpl-loading").html("Fetching friends...") }, A = function (e) { $(".inviter-tpl .tpl-loading").hide(), $(".inviter-tpl .tpl-default").show(), $(".inviter-tpl .all-contacts").html("All (" + e.friends.length + ")"), "" != e.error || (d(e.friends), r(F(), "all"), E(e.friends, l)) }, E = function () { }, P = function (e) { v(), e && (e.popup && (c = e.popup), e.send && (o = e.send)), 1 == c ? ($("#popupFIcontainer").css("position", "absolute"), $("#popupFIcontainer .generic_dialog_popup").draggable({ cancel: ".tpl-service-list,.textclass,.tpl-contacts,.messageTxt" }), j(), $("#popupFIcontainer .closeboxholder").show()) : ($("#popupFIcontainer").css("position", "relative"), $("#popupFIcontainer .closeboxholder").hide()), $(".inviter-tpl .subjectTxt").val("Friends Inviter"), $(".inviter-tpl .messageTxt").html("Hi, \n                 StesCodes Friends Inviter is so cool, am just playing around it. Am Inviting you to take a look at it, so that you will feel the same. \n                 Visit http://stescodes.com/invitefriends.aspx \n\n- StesCodes."), $(".inviter-tpl .tpl-header-icon").unbind("mouseover mouseout click"), $(".inviter-tpl .tpl-header-icon").bind({ mouseover: function () { $(this).find(".service-icon").addClass("service-icon-hover") }, mouseout: function () { $(this).find(".service-icon").removeClass("service-icon-hover") }, click: function () { $(".inviter-tpl .tpl-service-list:visible").length > 0 ? $(".inviter-tpl .tpl-service-list").hide() : $(".inviter-tpl .tpl-service-list").show() } }), $(".inviter-tpl .tpl-service-list ul li").unbind("click"), $(".inviter-tpl .tpl-service-list ul li").bind({ click: function () { friendsInviter.auth($(this).attr("service"), getFormattedKey()), $(".inviter-tpl .tpl-service-list").hide() } }) }, j = function () { jQuery(function () { var e = jQuery("#popupFIcontainer .generic_dialog_popup").offset(), t = 25; jQuery(window).scroll(function () { jQuery("#popupFIcontainer .generic_dialog_popup").stop().animate(jQuery(window).scrollTop() > e.top ? { marginTop: jQuery(window).scrollTop() - e.top + t } : { marginTop: 0 }) }) }) }, B = function (t, i) { var n = document.getElementById("overlay"), l = "visible"; l = "hidden" == t ? "hidden" : "visible", "hidden" == l ? "popup" == i ? $("#popupFIcontainer").fadeOut(500) : null != document.getElementById("popupFIcontainer") && $("#popupFIcontainer").fadeOut(500) : "popup" == i && (e(710, 650, i), $("#popupFIcontainer").fadeIn(500, function () { e(710, 650, i) })), n.style.visibility = l }, H = function () { $(".inviter-tpl").hide(), B("hidden", "popup") }; return { auth: _, clearSelection: k, init: P, load: A, select: h, fetchLoading: T, deSelect: m, showSelected: S, showAll: x, showsearch: O, messageSent: w, listener: p, getSelectedService: b, getSelected: C, storeSendAnalytics: y, storeGrabAnalytics: E, overlay: B, closewindow: H, getFriends: I } }();